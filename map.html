<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Travel Map</title>
<link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet" />
<link rel="shortcut icon" href="#" />
<style>
  html, body { margin: 0; height: 100%; background:#000; }
  #map { position: absolute; inset: 0; }

  /* thumbnail marker */
  .marker-img {
    width: 58px; height: 58px; object-fit: cover; display:block;
    border-radius: 8px; border:2px solid #fff; box-shadow: 0 2px 10px rgba(0,0,0,.7);
    cursor: pointer; background:#000;
  }

  /* tiny toast for load status */
  #status {
    position: fixed; left: 12px; bottom: 12px; z-index: 5;
    background: rgba(10,10,16,.6); color:#ddd;
    padding: 8px 10px; border-radius: 10px;
    border: 1px solid rgba(255,255,255,.08); backdrop-filter: blur(6px);
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif; font-size: 13px;
    max-width: min(80vw, 520px);
  }

  /* LIGHTBOX */
  #lightbox {
    position: fixed; inset: 0; z-index: 50;
    display: none; /* toggled via JS */
    align-items: center; justify-content: center;
    background: rgba(0,0,0,.86);
    backdrop-filter: blur(2px);
  }
  #lightbox.open { display: flex; }
  #lightbox .wrap {
    position: relative; display: inline-block;
  }
  #lightbox img.main {
    max-width: min(92vw, 1400px);
    max-height: 92vh;
    width: auto; height: auto; display:block;
    border-radius: 10px;
    box-shadow: 0 6px 18px rgba(0,0,0,.6);
  }
  #fourier-canvas {
    position:absolute; inset:0; pointer-events:none;
  }
  #lightbox .caption {
    margin-top: 10px; color:#e6e6e6; font: 500 14px/1.3 system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
    text-align: center;
  }
  #lightbox .chrome {
    position: absolute; inset: 0; display:flex; align-items:center; justify-content:space-between;
    pointer-events:none;
  }
  #lightbox .navbtn, #lightbox .close, .fourier-btn {
    pointer-events:auto;
    background: rgba(255,255,255,.12);
    color: #fff; border: 1px solid rgba(255,255,255,.25);
    border-radius: 999px; cursor: pointer;
    font: 600 14px/1 system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
    backdrop-filter: blur(2px);
  }
  #lightbox .close {
    position: absolute; top: 14px; right: 14px; padding: 8px 12px;
  }
  #lightbox .navbtn {
    width: 46px; height: 46px; display:flex; align-items:center; justify-content:center;
    margin: 0 12px;
  }
  #lightbox .navbtn:disabled { opacity:.4; cursor:not-allowed; }
  /* place nav vertically centered */
  #lightbox .chrome .left  { position:absolute; left: 8px;  top: 50%; transform: translateY(-50%); }
  #lightbox .chrome .right { position:absolute; right: 8px; top: 50%; transform: translateY(-50%); }

  /* Fourier controls cluster (top-left) */
  #fourier-controls {
    position:absolute; top:14px; left:14px; display:flex; gap:8px;
  }
  #fourier-controls .fourier-btn { padding: 8px 12px; }
</style>
</head>
<body>
  <div id="map"></div>
  <div id="status" hidden>Loading photos…</div>

  <!-- Lightbox -->
  <div id="lightbox" aria-modal="true" role="dialog">
    <button class="close" type="button" aria-label="Close">Close ✕</button>

    <div class="wrap">
      <img id="lightbox-img" class="main" alt="" />
      <!-- Canvas where outlines are drawn -->
      <canvas id="fourier-canvas"></canvas>
      <div id="lightbox-cap" class="caption"></div>
    </div>

    <div class="chrome">
      <div id="fourier-controls">
        <button id="btn-outline-toggle" class="fourier-btn" type="button" aria-label="Toggle outline">Outline</button>
        <button id="btn-circles-toggle" class="fourier-btn" type="button" aria-label="Toggle circles">Circles</button>
        <button id="btn-order" class="fourier-btn" type="button" aria-label="Set order">Order: 20</button>
      </div>
      <div class="left"><button id="btn-prev" class="navbtn" type="button" aria-label="Previous">⟨</button></div>
      <div class="right"><button id="btn-next" class="navbtn" type="button" aria-label="Next">⟩</button></div>
    </div>
  </div>

  <!-- MapLibre -->
  <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
  <!-- exifr (reads GPS from images) -->
  <script src="https://cdn.jsdelivr.net/npm/exifr/dist/lite.umd.js"></script>

  <!-- Optional: MapTiler key (or pass ?key=YOUR_KEY) -->
  <script>window.MAPTILER_KEY = "n6FyDnaUot032Ugli9xM"; </script>

  <!-- App (loads the map, lightbox, & wires the outline) -->
  <script src="js/blue-contours-map.js"></script>
  <!-- Fourier overlay module (defines window.initFourierOutline) -->
  <script type="module" src="js/fourier-outline.js"></script>
</body>
</html>
